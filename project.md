# A股超短复盘系统

## 项目定位

面向A股超短线交易者的**每日复盘与操作决策系统**。以龙头战法为核心，通过量化情绪指标 + 主观盘面判断，完成每日市场复盘，并输出次日操作计划。

**交易风格**：超短（T+1 ~ T+3），以打板、半路、低吸为主要手法  
**核心理念**：跟随市场最强方向，做龙头不做杂毛；尊重情绪周期，顺势而为

---

## 复盘框架（十大模块）

### 1. 大盘概览

跟踪三大指数（上证、深成指、创业板指）的涨跌与成交量，判断市场整体强弱。

**核心指标**：
- 三大指数涨跌幅、收盘点位及均线位置（重点关注5日/10日/20日线）
- 两市成交额及量能对比（与前日、5日均量对比）
- 涨跌家数与涨跌比

**判断标准**：
- 成交额持续放量 + 涨跌比 > 1 = 增量市场，可进攻
- 成交额萎缩 + 涨跌比 < 0.5 = 存量博弈，需防守
- 指数在5日线上方 = 短线偏多；跌破10日线 = 短线转弱

### 2. 竞价复盘（新增）

集合竞价是超短每天的第一战场，决定当日操作基调。

**核心观察**：
- 昨日龙头、连板股的竞价表现（高开幅度、竞价量、封单）
- 核心关注标的的竞价承接强度
- 整体高开/低开分布
- 竞价后是否需要调整盘前计划

### 3. 情绪核心数据

用 6 个维度量化当日市场情绪，计算综合得分（1-10分）。

| 指标 | 权重 | 意义 |
|------|------|------|
| 涨停家数 | 15% | 衡量市场赚钱效应的广度 |
| 封板率 | 15% | 衡量资金做多意愿的强度 |
| 昨涨停今日溢价率 | **25%** | 最重要指标，直接反映短线接力的盈亏比 |
| 最高连板高度 | 15% | 市场空间和高度的标尺 |
| 涨跌比 | 15% | 个股普涨/普跌程度 |
| 跌停家数（反指） | 15% | 亏钱效应的烈度 |

**综合得分公式**：  
`得分 = 涨停数×0.15 + 封板率×0.15 + 昨涨停溢价×0.25 + 连板高度×0.15 + 涨跌比×0.15 + 跌停反指×0.15`

**亏钱效应独立追踪**：
- 大面股数量（昨涨停/连板今日跌 > 5%）
- 大面比例（大面股 / 昨涨停总数），> 30% = 接力极度危险
- 连板梯队完整性（完整/断层/稀疏）

### 4. 情绪周期定位

根据情绪综合得分，定位当前市场所处的周期阶段：

| 阶段 | 得分区间 | 市场特征 | 操作策略 |
|------|----------|----------|----------|
| 冰点期 | 1-3 分 | 极度低迷，恐慌蔓延 | 空仓观望，等待转折信号 |
| 退潮/修复期 | 3-5 分 | 亏钱效应为主，试错成本高 | 控仓观察，只做最强辨识度龙头 |
| 回暖/上升期 | 5-7 分 | 赚钱效应回归，主线渐明 | 跟随龙头，逐步加仓 |
| 高潮期 | 7-9 分 | 赚钱效应强烈，连板梯队完整 | 重仓进攻，但警惕见顶信号 |
| 极度亢奋 | 9-10 分 | 百股涨停，情绪过热 | 开始防守，分批止盈 |

**进阶维度**：
- **周期内位置**：初期/中段/末期，操作策略差异巨大
- **大盘周期 vs 情绪周期**：共振做多最佳，共振做空最差，背离需谨慎
- **3日得分趋势**：连续升温/连续降温/反转

**关键转折信号**：
- 冰点→回暖：首板溢价转正、涨停数连续2日回升、有辨识度个股率先走出连板
- 高潮→退潮：龙头断板、昨涨停大面比例>30%、成交额突然萎缩、封板率骤降

### 5. 龙头梳理

超短的核心是**做龙头**。每日必须明确：

- **总龙头**：当前市场最高辨识度、最高人气的个股，是情绪的风向标
- **补涨龙/分支龙**：同题材或跨题材的第二梯队领涨股
- **前排助攻股**：龙头身边的小弟表现，直接反映板块人气
- **连板梯队**：从最高板到首板的完整梯队分布

**龙头分析维度**：
- 技术形态：沿5日线上攻/加速远离5日线/回踩5日线/跌破5日线
- 量价关系：缩量板(惜售) / 放量板(分歧) / 天量(警惕) / 缩量调整(洗盘)
- 换手率水平：偏低(惜售) / 适中(健康) / 过高(出货)
- 与指数关系：独立走强(辨识度高) / 跟随指数(辨识度一般)
- 辨识度评级：★ ~ ★★★★★
- 龙头所处阶段：启动期 / 主升期 / 加速赶顶期 / 见顶分歧期

**龙头演进三问**：
1. 连板梯队是否完整？是否出现断档？
2. 是否有新龙头萌芽？（关注首板中异常放量、大封单、高辨识度标的）
3. 总龙头见顶后，市场是否有承接？（有→新周期，无→退潮）

### 6. 题材板块分析

每日梳理 TOP3 强势题材，关注：

- **主线题材**：持续 3 天以上、有龙头引领、逻辑清晰的题材（政策/产业/事件驱动）
- **支线题材**：1-2 天的短期热点，参与需快进快出
- **板块轮动节奏**：主线清晰时跟主线做；快速轮动无主线时降低仓位

**题材生命周期**：启动 → 发酵 → 高潮 → 分歧 → 退潮  
最佳介入点：启动确认后的发酵期，而非高潮期

**进阶维度**：
- 每个题材标注当前生命周期阶段
- 跟踪后续催化剂（政策落地/会议/业绩等），判断发酵空间
- 昨日强势题材的延续性检验

### 7. 五日线低吸跟踪（新增）

低吸是打板之外的重要辅助手法，适用于强势股回踩的二次介入。

**候选池管理**：
- 跟踪主线龙头/强势股回踩5日线的位置和量价状态
- 低吸前提：缩量回踩（非放量下杀）、均线多头排列、题材仍在主线地位
- 每个标的设定明确的买点和止损位

**纪律约束**：冰点期不低吸、退潮题材不低吸、放量下杀不低吸

### 8. 持仓管理（新增）

每日持仓的跟踪与决策，防止"只管买不管卖"。

**持仓检视**：
- 每只持仓的成本、现价、盈亏、持有逻辑
- 止损位和目标位是否需要调整
- 明日操作计划（继续持有/加仓/减仓/清仓）及执行条件

### 9. 明日策略

基于当日复盘结论，输出次日操作计划：

- **情景预案**：强势延续/正常分歧/超预期走弱，分别对应什么操作
- **竞价策略**：核心股什么竞价表现执行买入，什么情况放弃
- **仓位规划**：根据情绪周期阶段决定仓位上限
- **关注方向**：具体标的 + 操作手法 + 买点价位 + 止损位
- **风险提示**：需回避的方向、潜在风险点

**仓位纪律**：
| 情绪阶段 | 建议仓位上限 |
|----------|-------------|
| 冰点期 | 0-1 成 |
| 退潮/修复期 | 1-3 成 |
| 回暖/上升期 | 3-6 成 |
| 高潮期 | 6-8 成 |
| 极度亢奋 | 开始减至 5 成以下 |

### 10. 交易纪律自检

每日交易后的自我审视，防止情绪化操作：

**操作回顾**：逐笔回顾当日买卖，标注操作类型（打板/半路/低吸/止损/止盈）和盈亏，评价每笔操作是正确执行还是冲动违纪

**纪律检查**：
- 是否按昨日计划执行
- 有无计划外的冲动交易
- 止损是否严格执行
- 是否追高接盘
- 仓位是否符合当前情绪周期阶段
- 是否在不该操作的时候操作了

---

## 数据来源

### 技术栈

- **主要数据库**：AKShare（开源免费，数据源为新浪 + 东方财富）
- **运行环境**：Python 3.9+
- **依赖**：akshare, pandas
- **采集脚本**：`scripts/fetch_daily_data.py`

### 复盘指标 → API 接口映射（2026-02 实测验证）

> 以下接口均已实测可用。东方财富 push2 系列接口（`*_em` 中的 `stock_zh_index_spot_em`、`stock_zh_a_spot_em`、`stock_board_*_name_em`）在 macOS 自带 LibreSSL 环境下存在 SSL 兼容问题，已全部替换为可用替代方案。

#### 模块一：大盘概览

| 复盘指标 | AKShare 接口 | 调用示例 | 状态 |
|----------|-------------|----------|------|
| 三大指数（点位/涨跌幅/成交额） | `stock_zh_index_spot_sina` | `ak.stock_zh_index_spot_sina()` 筛选 sh000001/sz399001/sz399006 | ✅ 已验证 |
| 涨跌家数/涨跌比 | `stock_zh_a_spot` | `ak.stock_zh_a_spot()` → 按涨跌幅统计上涨/下跌家数 | ✅ 已验证 |
| 两市成交额 | 指数接口派生 | 上证成交额 + 深证成交额 | ✅ 已验证 |
| 北向资金 | `stock_hsgt_hist_em` | `ak.stock_hsgt_hist_em(symbol="北向资金")` | ⚠ 2024.8 后仅月度披露 |

> **北向资金说明**：2024年8月19日起，沪深交易所调整为按月度披露，单日净买入数据不再实时公布。当前替代方案：通过东方财富网页端或财联社电报手动记录。

#### 模块二：情绪核心数据

| 复盘指标 | AKShare 接口 | 调用示例 | 状态 |
|----------|-------------|----------|------|
| 涨停家数 + 连板数 + 所属行业 | `stock_zt_pool_em` | `ak.stock_zt_pool_em(date="20260225")` | ✅ 已验证 |
| 炸板家数（封板率 = 涨停/(涨停+炸板)） | `stock_zt_pool_zbgc_em` | `ak.stock_zt_pool_zbgc_em(date="20260225")` | ✅ 已验证 |
| 跌停家数 | `stock_zt_pool_dtgc_em` | `ak.stock_zt_pool_dtgc_em(date="20260225")` | ✅ 已验证 |
| 昨涨停今日溢价率 | `stock_zt_pool_previous_em` | `ak.stock_zt_pool_previous_em(date="20260225")` → 取涨跌幅均值 | ✅ 已验证 |
| 最高连板 + 连板梯队 | `stock_zt_pool_em` | 同涨停池，按"连板数"字段分组 | ✅ 已验证 |

#### 模块五：题材板块分析

| 复盘指标 | 数据来源 | 说明 | 状态 |
|----------|----------|------|------|
| 涨停行业分布 TOP5 | `stock_zt_pool_em` | 涨停池按"所属行业"字段聚合统计 | ✅ 已验证 |
| 概念板块涨幅排名 | 东方财富网页端 | `stock_board_concept_name_em` 存在 SSL 兼容问题，暂手动获取 | ⚠ 需手动补充 |
| 行业板块涨幅排名 | 东方财富网页端 | `stock_board_industry_name_em` 同上 | ⚠ 需手动补充 |

### 数据采集脚本

```bash
# 单日模式 —— 采集今天的数据（自动保存至 data/YYYYMMDD.json）
python3 scripts/fetch_daily_data.py

# 单日模式 —— 采集指定日期
python3 scripts/fetch_daily_data.py 20260225

# 单日模式 —— 仅打印摘要，不保存文件
python3 scripts/fetch_daily_data.py 20260225 --print-only

# 批量模式 —— 采集日期范围内所有交易日（自动跳过已缓存日期）
python3 scripts/fetch_daily_data.py --range 20260210 20260225

# 批量模式 —— 采集最近 N 个交易日
python3 scripts/fetch_daily_data.py --days 10

# 批量模式 —— 采集并生成周期汇总报告
python3 scripts/fetch_daily_data.py --range 20260210 20260225 --summary

# 单日/批量默认会生成复盘草稿，保存至 每日复盘/YYYYMM/YYYY-MM-DD_draft.md；不需要草稿时加 --no-draft
python3 scripts/fetch_daily_data.py --no-draft

# 强制重新采集（忽略缓存）
python3 scripts/fetch_daily_data.py --range 20260210 20260225 --force
```

**每日 0 点执行**：无参数运行时会自动采集「最近一个交易日」的数据（0 点跑则为上一交易日）。可配合 cron 或 launchd 定时执行。包装脚本示例：

```bash
# 推荐：使用包装脚本（项目根目录下执行）
./scripts/run_daily_fetch.sh

# Cron 示例（每日 0 点执行，请将 /path/to/trade 改为实际项目路径）
0 0 * * * cd /path/to/trade && ./scripts/run_daily_fetch.sh
```

**脚本自动完成**：
- 采集三大指数、涨跌家数、涨停/炸板/跌停池、昨涨停溢价
- 计算情绪 6 维度评分 + 综合得分
- 生成连板梯队分布
- 聚合涨停行业 TOP5
- **板型推断**：根据首次/最后封板时间自动判定板型（一字板/T字板/秒板/换手板/分歧板/烂板/尾盘板）
- **连板股明细**：单独保存所有 2 板以上个股完整盘口数据，不受前20截断限制
- **个股增强**（单日模式）：交叉全A行情获取连板股的换手率、振幅、量比
- **量能分析**：自动对比昨日成交额（日环比）和 5 日均量
- 输出控制台摘要 + 保存 JSON 原始数据
- **批量模式**：自动识别交易日、增量更新（跳过已有数据）、生成周期汇总报告
- **复盘草稿**：单日或批量采集成功后，自动根据当日 JSON 生成 `每日复盘/YYYYMM/YYYY-MM-DD_draft.md`，填充大盘、情绪、连板梯队、题材 TOP3、量能异动等可自动填项，其余留空供人工补充；使用 `--no-draft` 可关闭草稿生成

**JSON 数据结构增强字段**：
| 字段 | 说明 | 来源 |
|------|------|------|
| `量能分析.日环比%` | 今日成交额 vs 昨日 | 历史缓存对比 |
| `量能分析.vs_5日均量%` | 今日成交额 vs 近5日均量 | 历史缓存对比 |
| `连板股明细[].板型` | 一字板/T字板/秒板/换手板/分歧板/烂板/尾盘板 | 封板时间推断 |
| `连板股明细[].换手率` | 当日换手率 | `stock_zh_a_spot`（仅单日模式） |
| `连板股明细[].振幅` | 当日最高-最低振幅 | `stock_zh_a_spot`（仅单日模式） |
| `连板股明细[].量比` | 量比 | `stock_zh_a_spot`（仅单日模式） |
| `量能异动_未涨停` | 未涨停但量比≥2 的个股列表（代码、名称、涨跌幅、量比、换手率、成交额），按量比降序前50 | `stock_zh_a_spot`（仅单日模式） |

**脚本耗时**：单日模式约 45-60 秒；批量模式约 2-3 秒/日（跳过全A行情接口）

**汇总报告包含**：区间统计、指数走势表、情绪数据表、情绪走势曲线、龙头演进追踪、题材轮动汇总

### 数据可靠性说明

| 数据源 | 优势 | 局限 | 可靠性 |
|--------|------|------|--------|
| AKShare 新浪源 | 免费、指数和全A行情稳定 | 涨跌家数与东财官网可能有微小差异 | ★★★★☆ |
| AKShare 东财涨停专题 | 免费、涨停/炸板/跌停/昨涨停溢价数据齐全 | 仅保留近半年历史，需自行归档 | ★★★★★ |
| 东方财富网页端 | 实时性最好，概念/行业板块数据最全 | 手动获取，无法自动化 | ★★★★☆ |
| Tushare Pro | 数据全面、历史深度好 | 核心涨停接口需高积分（2000+） | ★★★★★ |
| 同花顺 iFinD | 专业级，昨涨停溢价最准确 | 价格昂贵，面向机构 | ★★★★★ |

### 推荐方案

**日常自动化**：运行 `fetch_daily_data.py`，覆盖 90%+ 复盘指标  
**手动补充**：概念板块 TOP3、北向资金（从东方财富网页端获取）  
**数据归档**：每日 JSON 自动保存至 `data/` 目录，防止历史数据过期丢失

### 策略包（Cursor Skill）

将「大神」或某套思路总结成 Cursor 策略包后，可在对话中根据复盘总结输出：市场理解、选股逻辑、周期判断、明日推演、量能看法、买卖点建议。

**策略包位置**：`.cursor/skills/strategy-<名称>/SKILL.md`（如 `strategy-龙头情绪`、`strategy-预期差`）。

**如何新增一个策略包**：
1. 复制 `.cursor/skills/strategy-template/SKILL.md` 到新目录 `.cursor/skills/strategy-<名称>/SKILL.md`。
2. 修改 frontmatter 的 `name`、`description`，在「本策略规则」中填入从大神摘录中提炼的规则（核心逻辑、选股条件、周期判断、买卖点、明日推演框架等）。若摘录较长，可先让 AI 根据 `知识库/策略源/xxx` 下的原始摘录做一次性总结，再把总结写进 SKILL 的「本策略规则」。
3. 保存后，在 Cursor 中通过 @ 该 Skill 或说明「用 xxx 策略看盘」即可使用。

**如何使用**：在对话中 @ 当日复盘文件（如 `每日复盘/202602/2026-02-25.md`）或粘贴复盘内容，并 @ 对应策略包（如 `strategy-龙头情绪`），模型会按该策略的六部分框架输出。

**策略源与一次性总结**：可将大神的原始摘录放在 `知识库/策略源/<大神或策略名>/` 下。需要生成或更新某策略包时，在 Cursor 中请求「根据 知识库/策略源/xxx 的内容，总结成策略规则并更新 .cursor/skills/strategy-xxx/SKILL.md」即可（一次性总结，不做持续增量更新）。

---

## 文件组织

```
trade/
├── project.md                  # 项目说明（本文件）
├── requirements.txt            # Python 依赖
├── 复盘模板/
│   └── 复盘模版.md             # 每日复盘标准模板
├── scripts/
│   ├── fetch_daily_data.py     # 每日数据自动采集脚本
│   └── run_daily_fetch.sh     # 每日 0 点/盘后一键采集（无参数即采最近一交易日）
├── data/                       # 每日采集的原始 JSON 数据
│   ├── 20260225.json
│   └── ...
├── 每日复盘/                   # 按月份子目录存放每日复盘
│   ├── 202602/
│   │   ├── 2026-02-24.md
│   │   ├── 2026-02-25.md
│   │   └── ...
│   └── 202603/
│       └── ...
├── 周度复盘/                   # 周度汇总复盘
│   ├── 周度复盘_20260225.md
│   └── ...
└── 知识库/                     # 交易知识沉淀
    ├── README.md                # 知识库与策略源说明
    ├── 龙头战法.md
    ├── 情绪周期模型.md
    ├── 常见错误复盘.md
    └── 策略源/                 # 大神原始摘录（供 AI 一次性总结为策略包）
        └── <大神或策略名>/
            └── ...
.cursor/skills/                 # Cursor 策略包（需在项目根 .cursor 下）
    ├── strategy-template/      # 策略包模板，复制后改名使用
    └── strategy-龙头情绪/      # 示例：龙头+情绪周期策略

---

## 复盘工作流

### 每日复盘流程（收盘后 19:00 ~ 21:30）

```
1. 数据采集 + 竞价回顾（15 分钟）
   ├── 运行 fetch_daily_data.py 采集量化数据
   ├── 三大指数收盘 + 均线位置
   ├── 量能对比（vs 昨日 / vs 5日均量）
   └── 回顾今日竞价表现，记录核心股竞价结果

2. 情绪评分 + 亏钱效应（10 分钟）
   ├── 6维度打分 + 综合得分
   ├── 大面股统计（昨涨停今日跌>5%）
   ├── 连板梯队完整性判断
   └── 定位情绪周期阶段 + 周期内位置

3. 龙头深度分析（15 分钟）
   ├── 总龙头：技术形态/量价/换手/辨识度/与指数关系
   ├── 补涨龙/前排助攻股表现
   ├── 连板梯队分布
   └── 龙头演进判断（断档/新龙萌芽/承接）

4. 题材分析（10 分钟）
   ├── TOP3 题材 + 生命周期定位
   ├── 主线 vs 支线定性
   ├── 后续催化剂跟踪
   └── 板块轮动节奏

5. 低吸候选 + 持仓检视（10 分钟）
   ├── 五日线低吸候选池更新
   ├── 持仓个股盈亏/逻辑/止损检视
   └── 持仓明日操作计划

6. 明日策略（15 分钟）
   ├── 情景预案（强/中/弱三种情况）
   ├── 竞价策略（什么表现执行/放弃）
   ├── 仓位规划 + 具体标的 + 买卖点 + 止损
   └── 风险提示

7. 纪律自检（5 分钟）
   ├── 逐笔操作回顾与评价
   └── 总结收获与教训
```

### 周度复盘流程（每周五收盘后或周末）

- 汇总本周每日情绪得分，绘制情绪曲线
- 回顾本周龙头演进（诞生→加速→见顶→接力）
- 总结本周主线题材的持续性与轮动规律
- 检视本周交易纪律执行情况
- 制定下周操作思路与仓位框架

---

## 核心原则

1. **数据先行，主观辅助**：先看客观数据（涨停数、封板率、溢价率），再做主观判断，避免"先有结论再找证据"
2. **龙头为王**：只做市场辨识度最高的个股，不碰杂毛和补涨末流
3. **尊重周期**：情绪冰点不抄底赌反转，情绪高潮不贪心恋战
4. **严格纪律**：每日复盘不能敷衍，明日策略必须在盘前写好，盘中严格执行
5. **持续迭代**：定期回顾复盘质量，优化评分模型和策略框架
